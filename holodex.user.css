/* ==UserStyle==

@name           Holodex & Hyperchat Tweaks
@namespace      https://github.com/Himither
@homepageURL		https://github.com/Himither/Holodex-Hyperchat-Tweaks
@supportURL			https://github.com/Himither/Holodex-Hyperchat-Tweaks/issues
@version        1.1.8
@updateURL	    https://raw.githubusercontent.com/Himither/Holodex-Hyperchat-Tweaks/master/holodex.user.css
@description    Improved dark mode, adjustable chat width, hiding scrollbars/buttons and many more tweaks.
@author         Himither
@license        MIT
@preprocessor   stylus

@var text Holodex "------------------------------------------------------" '---Holodex---'
@var select darkmode "Dark Mode"   {
  "Default": "normal",
  "Darker*": "darker",
  "La+ Darknesss": "darkness"
}
@var number sidemenuWidth "Set navigation menu width (170px - 1080px)" [220, 170, 1080, 1, "px"]
@var checkbox borderlessHolodex "Borderless Holodex" 1
@var checkbox hoverOverlay "Show video overlay only on video hover" 0
@var select changeAvatar "Change Avatar Image" {
 "None": "none",
 "Anchor*": "'https://raw.githubusercontent.com/Himither/Holodex-Hyperchat-Tweaks/main/avatar/anchor.webp'",
 "Custom": "avatarCustom"
}
@var text avatarCustom "Custom avatar (Link to an image/Data URL wrapped in single quotes)" "''"
@var range avatarSize "Adjust avatar size" [100, 50, 150, 1, "%"]

@var text Singleview "------------------------------------------------------" '---Singleview---'
@var number sidebarWidth  "Adjust the chat/TLdex width (170px - 1080px)" [340, 170, 1080, 1, "px"]
@var checkbox videoMaxHeight "Increase video height to 100% (Best with Holodex Theatre Mode)" 0

@var text Multidex "------------------------------------------------------" '---Multidex---'
@var checkbox hoverToolbarButton "Show top-right toolbar button only on mouse hover" 0
@var checkbox hoverChatButtons "Show bottom-right chat buttons only on mouse hover" 0
@var checkbox hoverArchiveSync "Show Archive Sync only on mouse hover" 0

@var text Youtube "------------------------------------------------------" '---YouTube---'
@var number yt-menuWidth "Change side menu width" [240, 170, 1080, 1, "px"]
@var checkbox yt-black "Use black background" 0
@var checkbox yt-borderlessChat "Hide chat borders" 0
@var checkbox yt-useWidth "Use 100% width when watching videos (progess bar is a bit iffy)" 0
@var checkbox yt-hoverHeader "Show header only on hover" 0
@var checkbox yt-hoverSecondary "Show right column only on hover, when chat is closed" 0

@var text YouTubeChat "------------------------------------------------------" '---YouTube Chat---'
@var checkbox showLabel "Show \"Live chat replay\" as label" 0
@var checkbox showDropdownMenu "Show dropdown menu again" 0
@var checkbox showButtons "Show hidden buttons (for use on YouTube)" 0

@var text Hyperchat "------------------------------------------------------" '---Hyperchat---'
@var checkbox hideHolodexInfo "Hide Hyperchat Notice (Please 👍 and ⭐ Hyperchat)" 0

@var text Themes "------------------------------------------------------" '---Themes---'
@var select theme "Select a theme" {
"None*": "none",
"Aqua": "aqutan"
}

@var text Scrollbars "------------------------------------------------------" '---Scrollbars---'
@var checkbox hideHolodexScrollbars "Hide Holodex scrollbars" 0
@var checkbox hideYoutubeChatScrollbars "Hide YouTube-Chat scrollbars" 0
@var checkbox hideHyperchatScrollbars "Hide Hyperchat scrollbars" 0
@var checkbox hateScrollbars "Hide scrollbars everywhere on the internet" 0

==/UserStyle== */
@-moz-document url-prefix("https://holodex.net") {

	.v-navigation-drawer--open {
		width: sidemenuWidth !important;
	}

	.v-application--wrap:has(.v-navigation-drawer--open):not(:has(.video)):not(:has(.mv-background)) main {
		padding-left: sidemenuWidth !important;
	}

	if darkmode==darker {

		.v-main,
		.v-sheet,
		.watch-layout,
		.multiview,
		.vue-grid-layout,
		{
			background-color: black !important;
		}

		nav .v-list.v-sheet,
		.v-navigation-drawer__content,
		.v-tabs-bar,
		.v-expansion-panel-content,
		.v-expansion-panel,
		.v-input__slot,
		.topic-chip,
		.v-bottom-navigation {
			background-color: var(--v-background-base) !important;
		}
	}

	if darkmode==darkness {

		.v-main,
		.v-sheet,
		.watch-layout,
		.multiview,
		.vue-grid-layout,
		.v-app-bar.v-toolbar.v-sheet,
		.v-navigation-drawer__content,
		.v-tabs-bar,
		.v-expansion-panel-content,
		.v-bottom-navigation {
			background-color: black !important;
		}

		button:not(.video-card-action) {
			background-color: transparent !important;
		}


		header .v-input__slot,
		.v-expansion-panel,
		.topic-chip {
			background-color: var(--v-background-base) !important;
		}
	}

	if borderlessHolodex {

		.sidebar,
		.watch-live-chat {
			border-color: black !important;
		}

		#bottom-bar,
		.mv-cell,
		.v-divider {
			border-color: transparent !important;
		}

		.v-navigation-drawer__border {
			opacity: 0 !important;
		}

		.layout-preview {
			border-color: var(--v-primary-base) !important;
		}

		.layout-preview-cell {
			border: none !important;
		}
	}

	if hideHolodexScrollbars {

		* {
			scrollbar-width: none !important;
		}
	}

	if theme==aqutan {

		.tl-name,
		.subtitle-text,
		.v-application .red--text,
		:is(.channel-container, .watch-card) .v-list-item__title {
			color: rgb(240, 98, 146) !important;
		}

		.tl-message .tl-caption,
		.text--org {
			color: rgb(59, 136, 213) !important;
		}

		.subtitle-text {
			text-shadow: 2px 2px 5px rgb(59, 136, 213);
		}

		.watch-btn-group button.v-btn:first-child .v-icon__svg {
			fill: rgb(59, 136, 213) !important;
		}
	}

	if changeAvatar!="none" {

		header:not(.mv-toolbar) .v-avatar,
		.v-menu__content .v-avatar {
			height: 0 !important;
			width: 0 !important;
			padding-left: 40px !important;
			padding-top: 40px !important;
			background-image: url(changeAvatar) !important;
			background-position: center !important;
			background-size: avatarSize !important;
		}
	}
}

@-moz-document url-prefix("https://holodex.net/watch") {

	.sidebar {
		min-width: sidebarWidth !important;
	}

	if videoMaxHeight {
		.watch-layout.full-height:not(.mobile).show-highlights-bar .video,
		.watch-layout.full-height:not(.mobile) .video {
			height: 100dvh !important;
		}

		.video {
			height: calc(100dvh - 56px) !important;
		}
	}
}

@-moz-document url-prefix("https://holodex.net/multiview") {

	if hoverToolbarButton {

		.open-mv-toolbar-btn {
			opacity: 0 !important;
			transition: opacity 300ms ease-in-out !important;
			border-bottom-left-radius: 5px !important;
		}

		.open-mv-toolbar-btn:hover {
			opacity: 0.7 !important;
			background: var(--v-secondary-base) !important;
		}
	}

	if hoverChatButtons {

		.vue-grid-item > .mv-cell > .cell-content > .d-flex:last-child:not(.cell-control) {
			position: absolute !important;
			right: 0 !important;
			bottom: 0 !important;
			width: 100% !important;
			opacity: 0 !important;
			transition: opacity 300ms ease-in-out !important;
			background-color: black !important;
		}

		.vue-grid-item > .mv-cell > .cell-content > .d-flex:last-child:not(.cell-control):hover {
			opacity: 1 !important;
		}
	}

	if hoverArchiveSync {
		.sync-bar.d-flex {
			opacity: 0 !important;
		}
		.sync-bar.d-flex:hover {
			opacity: 1 !important;
		}
	}
}

@-moz-document url-prefix("https://www.youtube.com/embed") {

	if hoverOverlay {

		#movie_player:not(:hover) {
			.ytp-large-play-button,
			.ytp-gradient-top,
			.ytp-chrome-top,
			.ytp-gradient-bottom,
			.ytp-chrome-bottom,
			.ytp-player-content {
				opacity: 0;
			}
		}
	}
}

@-moz-document url-prefix("https://www.youtube.com/live_chat") {

	#primary-content.yt-live-chat-header-renderer {
		margin-left: 4px !important;
	}

	if darkmode==darker or darkmode==darkness {

		yt-live-chat-message-input-renderer,
		yt-live-chat-header-renderer,
		yt-live-chat-ticker-renderer,
		#chat-messages,
		yt-formatted-string,
		{
			background: black !important;
		}

		yt-icon-button,
		{
			background: transparent !important;
		}
	}

	if darkmode==darkness {

		#input-container,
		#search-panel,
		tp-yt-paper-listbox.yt-dropdown-menu {
			background: black !important;
		}
	}

	if !showDropdownMenu {

		yt-live-chat-header-renderer[prevent-chat-header-overflow] #view-selector.yt-live-chat-header-renderer {
			display: none !important;
		}

		span#title::after {
			content: "Live" !important;
			white-space: pre !important;
			color: white !important;
			display: block !important;
		}

		if showLabel {

			span#title::after {
				content: "Live chat replay" !important;
				white-space: pre !important;
				color: white !important;
				display: block !important;
			}
		}
	}

	if !showButtons {

		yt-live-chat-button,
		div#close-button {
			display: none !important;
		}
	}

	#separator.yt-live-chat-renderer,
	#panel-pages.yt-live-chat-renderer {
		border: black !important;
	}

	if hideYoutubeChatScrollbars {

		* {
			scrollbar-width: none !important;
		}
	}

	if theme==aqutan {

		div#content #author-name:not(.moderator) {
			color: rgb(59, 136, 213) !important;
		}

		div#content #author-name.moderator {
			color: green !important;
		}

		div#content :is(#author-name.member,
		span#title::after) {
			color: rgb(240, 98, 146) !important;
		}

		span#title::after,
		#trigger :is(#label-text,
		#label-icon) {
			color: rgb(240, 98, 146) !important;
			text-shadow: -2px 2px 1.0px rgb(59, 136, 213);
		}
	}
}

@-moz-document url-prefix("https://www.youtube.com/") {

	#guide-content,
	#guide-renderer {
		width: yt-menuWidth !important;
	}
}

@-moz-document url-prefix("https://www.youtube.com/watch") {

	:root {
		--chat-height: calc(100dvh - 56px);

		if yt-hoverHeader {
			--chat-height: calc(100dvh - 104px);
		}
	}

	if yt-black {
		ytd-app {
			background: black !important;
		}
	}

	if yt-borderlessChat {
		#chat {
			border-color: transparent !important;
		}
	}


	if yt-useWidth {
		#columns {
			max-width: 100% !important;
		}

		.ytp-player-content,
		.ytp-iv-video-content,
		.html5-video-container,
		video.video-stream {
			width: 100% !important;
			height: 100% !important;
		}

		.ytp-chrome-bottom {
			width: 100% !important;
			left: 0 !important;
		}

		.ytp-player-content.ytp-iv-player-content {
			left: 0 !important;
			right: 0 !important;
		}

		#player {
			height: calc(100dvh - 24px) !important;
		}

		#chat-container {
			height: calc(100dvh - 24px) !important;
		}

		#chat {
			height: var(--chat-height) !important;
		}

		#player {
			display: inline-flex !important;
			width: 100% !important;
			align-items: center !important;
		}

		#player-container-outer {
			width: 100% !important;
		}

		.ytp-tooltip:not([aria-hidden="true"]) {
			top: calc(100% - 96px) !important;
		}

		.ytp-tooltip:not([aria-hidden="true"]).ytp-preview {
			top: calc(100% - 224px) !important;
		}

		#player:has(.ytp-show-tiles) .video-stream {
			display: none !important;
		}
	}

	if yt-hoverHeader {

		#primary {
			position: relative !important;
		}

		#secondary {
			padding-top: 56px !important;
		}

		#page-manager.ytd-app {
			margin-top: 0 !important;
		}

		#content #masthead-container {
			opacity: 0 !important;
		}

		#content:not(:has(#chat-container:hover)) #masthead-container:hover {
			opacity: 1 !important;
			background-color: black !important;
		}
	}


	if yt-hoverSecondary {
		#columns:has(ytd-live-chat-frame[collapsed]) #secondary {
			position: absolute !important;
			right: 0 !important;
			opacity: 0 !important;
			transition: opacity 300ms ease-in-out, background 300ms ease-in-out !important;
		}

		#primary {
			z-index: 1 !important;
			transition: z-index 300ms ease-in-out !important;
		}

		#content:has(ytd-live-chat-frame[collapsed]):not(:has(:is(#primary:hover, #masthead-container:hover))) #primary {
			z-index: 0 !important;
		}


		#content:has(ytd-live-chat-frame[collapsed]):not(:has(:is(#primary:hover, #masthead-container:hover))) #secondary {
			opacity: 1 !important;
			background-color: black !important;
		}
	}
}

@-moz-document url-prefix("https://www.youtube.com/embed/hyperchat_embed") {

	if darkmode==darker or darkmode==darkness {

		.hyperchat-root,
		.hyperchat-root > div.w-full > div.flex {
			background: black !important;
		}
	}

	if hideHyperchatScrollbars {

		* {
			scrollbar-width: none !important;
		}
	}

	if hideHyperchatScrollbars or hateScrollbars {

		div.hyperchat-root div.w-full {
			padding-bottom: 4px !important;
		}
	}

	if hideHolodexInfo {

		div.hover-highlight:not(.flex) {
			display: none !important;
		}
	}

	if theme==aqutan {

		div.content > div > div > div > a > span:not(.text-moderator-light) {
			color: rgb(59, 136, 213) !important;
		}

		div.content > div > div > div > a > span.text-moderator-light {
			color: green !important;
		}

		div.content > div > div > div > a > span.text-member-light {
			color: rgb(240, 98, 146) !important;
		}
	}
}

@-moz-document url-prefix("https://") {
	if hateScrollbars {

		* {
			scrollbar-width: none !important;
		}
	}
}